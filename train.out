2024-04-10 13:14:55.273175: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-04-10 13:14:56.043427: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT
>>>> Detect Device cuda
==> Preparing data..
>>>>> Map class to new label {1: 0, 5: 1, 14: 2, 20: 3, 52: 4, 71: 5, 74: 6, 87: 7, 92: 8, 99: 9, 102: 10, 103: 11, 106: 12, 116: 13, 121: 14, 130: 15, 149: 16, 151: 17, 179: 18, 188: 19}
>>>>>> Num trained class 20
Synthetic pattern:  
results/tiny-imagenet-syn-baseline
==> Synthetic Training data loaded.. Size: 30000
Number of data per class 500
>>>>> ResNet resolution:  64  <<<<<
>>> Select top lowest probability
  0%|          | 0/235 [00:00<?, ?it/s]/home/docker_user/miniconda3/envs/di/lib/python3.10/multiprocessing/popen_fork.py:66: RuntimeWarning: os.fork() was called. os.fork() is incompatible with multithreaded code, and JAX is multithreaded, so this will likely lead to a deadlock.
  self.pid = os.fork()
  0%|          | 1/235 [00:06<26:57,  6.91s/it]  1%|          | 2/235 [00:07<13:31,  3.48s/it]  1%|â–         | 3/235 [00:09<09:19,  2.41s/it]  2%|â–         | 4/235 [00:10<07:11,  1.87s/it]  2%|â–         | 5/235 [00:11<06:02,  1.58s/it]  3%|â–         | 6/235 [00:12<05:24,  1.42s/it]  3%|â–         | 7/235 [00:13<05:07,  1.35s/it]  3%|â–         | 8/235 [00:14<04:57,  1.31s/it]  4%|â–         | 9/235 [00:15<04:44,  1.26s/it]  4%|â–         | 10/235 [00:16<04:25,  1.18s/it]  5%|â–         | 11/235 [00:18<04:21,  1.17s/it]  5%|â–Œ         | 12/235 [00:19<04:16,  1.15s/it]  6%|â–Œ         | 13/235 [00:20<04:18,  1.16s/it]  6%|â–Œ         | 14/235 [00:21<04:14,  1.15s/it]  6%|â–‹         | 15/235 [00:22<04:13,  1.15s/it]  7%|â–‹         | 16/235 [00:23<04:14,  1.16s/it]  7%|â–‹         | 17/235 [00:25<04:14,  1.17s/it]  8%|â–Š         | 18/235 [00:26<04:15,  1.18s/it]  8%|â–Š         | 19/235 [00:27<04:06,  1.14s/it]  9%|â–Š         | 20/235 [00:28<04:09,  1.16s/it]  9%|â–‰         | 21/235 [00:29<04:10,  1.17s/it]  9%|â–‰         | 22/235 [00:30<04:13,  1.19s/it] 10%|â–‰         | 23/235 [00:32<04:09,  1.18s/it] 10%|â–ˆ         | 24/235 [00:33<04:03,  1.16s/it] 11%|â–ˆ         | 25/235 [00:34<03:57,  1.13s/it] 11%|â–ˆ         | 26/235 [00:35<03:49,  1.10s/it] 11%|â–ˆâ–        | 27/235 [00:36<03:43,  1.08s/it] 12%|â–ˆâ–        | 28/235 [00:37<03:39,  1.06s/it] 12%|â–ˆâ–        | 29/235 [00:38<03:45,  1.10s/it] 13%|â–ˆâ–        | 30/235 [00:39<03:50,  1.12s/it] 13%|â–ˆâ–        | 31/235 [00:40<03:56,  1.16s/it] 14%|â–ˆâ–        | 32/235 [00:42<03:53,  1.15s/it] 14%|â–ˆâ–        | 33/235 [00:43<03:51,  1.15s/it] 14%|â–ˆâ–        | 34/235 [00:44<03:47,  1.13s/it] 15%|â–ˆâ–        | 35/235 [00:45<03:43,  1.12s/it] 15%|â–ˆâ–Œ        | 36/235 [00:46<03:34,  1.08s/it] 16%|â–ˆâ–Œ        | 37/235 [00:47<03:35,  1.09s/it] 16%|â–ˆâ–Œ        | 38/235 [00:48<03:38,  1.11s/it] 17%|â–ˆâ–‹        | 39/235 [00:49<03:46,  1.15s/it] 17%|â–ˆâ–‹        | 40/235 [00:50<03:40,  1.13s/it] 17%|â–ˆâ–‹        | 41/235 [00:52<03:35,  1.11s/it] 18%|â–ˆâ–Š        | 42/235 [00:53<03:31,  1.10s/it] 18%|â–ˆâ–Š        | 43/235 [00:54<03:36,  1.13s/it] 19%|â–ˆâ–Š        | 44/235 [00:55<03:38,  1.14s/it] 19%|â–ˆâ–‰        | 45/235 [00:56<03:34,  1.13s/it] 20%|â–ˆâ–‰        | 46/235 [00:57<03:36,  1.14s/it] 20%|â–ˆâ–ˆ        | 47/235 [00:58<03:32,  1.13s/it] 20%|â–ˆâ–ˆ        | 48/235 [00:59<03:26,  1.11s/it] 21%|â–ˆâ–ˆ        | 49/235 [01:00<03:19,  1.07s/it] 21%|â–ˆâ–ˆâ–       | 50/235 [01:01<03:15,  1.06s/it] 22%|â–ˆâ–ˆâ–       | 51/235 [01:02<03:13,  1.05s/it] 22%|â–ˆâ–ˆâ–       | 52/235 [01:03<03:09,  1.03s/it] 23%|â–ˆâ–ˆâ–       | 53/235 [01:04<03:09,  1.04s/it] 23%|â–ˆâ–ˆâ–       | 54/235 [01:06<03:12,  1.06s/it] 23%|â–ˆâ–ˆâ–       | 55/235 [01:07<03:11,  1.06s/it] 24%|â–ˆâ–ˆâ–       | 56/235 [01:08<03:10,  1.06s/it] 24%|â–ˆâ–ˆâ–       | 57/235 [01:09<03:13,  1.09s/it] 25%|â–ˆâ–ˆâ–       | 58/235 [01:10<03:08,  1.07s/it] 25%|â–ˆâ–ˆâ–Œ       | 59/235 [01:11<03:04,  1.05s/it] 26%|â–ˆâ–ˆâ–Œ       | 60/235 [01:12<03:06,  1.07s/it] 26%|â–ˆâ–ˆâ–Œ       | 61/235 [01:13<03:12,  1.10s/it] 26%|â–ˆâ–ˆâ–‹       | 62/235 [01:14<03:11,  1.11s/it] 27%|â–ˆâ–ˆâ–‹       | 63/235 [01:15<03:11,  1.12s/it] 27%|â–ˆâ–ˆâ–‹       | 64/235 [01:17<03:16,  1.15s/it] 28%|â–ˆâ–ˆâ–Š       | 65/235 [01:18<03:21,  1.19s/it] 28%|â–ˆâ–ˆâ–Š       | 66/235 [01:19<03:20,  1.18s/it] 29%|â–ˆâ–ˆâ–Š       | 67/235 [01:20<03:23,  1.21s/it] 29%|â–ˆâ–ˆâ–‰       | 68/235 [01:22<03:21,  1.21s/it] 29%|â–ˆâ–ˆâ–‰       | 69/235 [01:23<03:20,  1.21s/it] 30%|â–ˆâ–ˆâ–‰       | 70/235 [01:24<03:20,  1.22s/it] 30%|â–ˆâ–ˆâ–ˆ       | 71/235 [01:25<03:19,  1.22s/it] 31%|â–ˆâ–ˆâ–ˆ       | 72/235 [01:26<03:17,  1.21s/it] 31%|â–ˆâ–ˆâ–ˆ       | 73/235 [01:28<03:16,  1.21s/it] 31%|â–ˆâ–ˆâ–ˆâ–      | 74/235 [01:29<03:16,  1.22s/it] 32%|â–ˆâ–ˆâ–ˆâ–      | 75/235 [01:30<03:11,  1.20s/it] 32%|â–ˆâ–ˆâ–ˆâ–      | 76/235 [01:31<03:08,  1.18s/it] 33%|â–ˆâ–ˆâ–ˆâ–      | 77/235 [01:32<03:00,  1.14s/it] 33%|â–ˆâ–ˆâ–ˆâ–      | 78/235 [01:33<02:55,  1.11s/it] 34%|â–ˆâ–ˆâ–ˆâ–      | 79/235 [01:34<02:47,  1.08s/it] 34%|â–ˆâ–ˆâ–ˆâ–      | 80/235 [01:35<02:43,  1.05s/it] 34%|â–ˆâ–ˆâ–ˆâ–      | 81/235 [01:36<02:44,  1.07s/it] 35%|â–ˆâ–ˆâ–ˆâ–      | 82/235 [01:37<02:40,  1.05s/it] 35%|â–ˆâ–ˆâ–ˆâ–Œ      | 83/235 [01:38<02:41,  1.06s/it] 36%|â–ˆâ–ˆâ–ˆâ–Œ      | 84/235 [01:39<02:38,  1.05s/it] 36%|â–ˆâ–ˆâ–ˆâ–Œ      | 85/235 [01:41<02:39,  1.07s/it] 37%|â–ˆâ–ˆâ–ˆâ–‹      | 86/235 [01:42<02:44,  1.10s/it] 37%|â–ˆâ–ˆâ–ˆâ–‹      | 87/235 [01:43<02:42,  1.10s/it] 37%|â–ˆâ–ˆâ–ˆâ–‹      | 88/235 [01:44<02:42,  1.11s/it] 38%|â–ˆâ–ˆâ–ˆâ–Š      | 89/235 [01:45<02:44,  1.13s/it] 38%|â–ˆâ–ˆâ–ˆâ–Š      | 90/235 [01:46<02:43,  1.13s/it] 39%|â–ˆâ–ˆâ–ˆâ–Š      | 91/235 [01:47<02:41,  1.12s/it] 39%|â–ˆâ–ˆâ–ˆâ–‰      | 92/235 [01:49<02:41,  1.13s/it] 40%|â–ˆâ–ˆâ–ˆâ–‰      | 93/235 [01:50<02:42,  1.14s/it] 40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 94/235 [01:51<02:40,  1.14s/it] 40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 95/235 [01:52<02:35,  1.11s/it] 41%|â–ˆâ–ˆâ–ˆâ–ˆ      | 96/235 [01:53<02:36,  1.12s/it] 41%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 97/235 [01:54<02:34,  1.12s/it] 42%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 98/235 [01:55<02:36,  1.14s/it] 42%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 99/235 [01:56<02:33,  1.13s/it] 43%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 100/235 [01:58<02:32,  1.13s/it] 43%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 101/235 [01:59<02:32,  1.14s/it] 43%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 102/235 [02:00<02:27,  1.11s/it] 44%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 103/235 [02:01<02:26,  1.11s/it] 44%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 104/235 [02:02<02:22,  1.09s/it] 45%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 105/235 [02:03<02:20,  1.08s/it] 45%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 106/235 [02:04<02:17,  1.06s/it] 46%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 107/235 [02:05<02:16,  1.07s/it] 46%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 108/235 [02:06<02:17,  1.08s/it] 46%|â–ˆâ–ˆâ–ˆâ–ˆâ–‹     | 109/235 [02:07<02:15,  1.07s/it] 47%|â–ˆâ–ˆâ–ˆâ–ˆâ–‹     | 110/235 [02:08<02:13,  1.07s/it] 47%|â–ˆâ–ˆâ–ˆâ–ˆâ–‹     | 111/235 [02:09<02:12,  1.07s/it] 48%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 112/235 [02:10<02:09,  1.05s/it] 48%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 113/235 [02:12<02:10,  1.07s/it] 49%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 114/235 [02:13<02:09,  1.07s/it] 49%|â–ˆâ–ˆâ–ˆâ–ˆâ–‰     | 115/235 [02:14<02:12,  1.11s/it] 49%|â–ˆâ–ˆâ–ˆâ–ˆâ–‰     | 116/235 [02:15<02:12,  1.11s/it] 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–‰     | 117/235 [02:16<02:09,  1.10s/it] 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 118/235 [02:17<02:08,  1.10s/it] 51%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 119/235 [02:18<02:09,  1.12s/it] 51%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 120/235 [02:19<02:12,  1.15s/it] 51%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 121/235 [02:21<02:11,  1.15s/it] 52%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 122/235 [02:22<02:09,  1.15s/it] 52%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 123/235 [02:23<02:10,  1.16s/it] 53%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 124/235 [02:24<02:10,  1.18s/it] 53%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 125/235 [02:25<02:10,  1.18s/it] 54%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 126/235 [02:27<02:10,  1.19s/it] 54%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 127/235 [02:28<02:08,  1.19s/it] 54%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 128/235 [02:29<02:05,  1.17s/it] 55%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 129/235 [02:30<02:03,  1.16s/it] 55%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 130/235 [02:31<02:05,  1.20s/it] 56%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 131/235 [02:32<02:02,  1.18s/it] 56%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 132/235 [02:34<02:00,  1.17s/it] 57%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹    | 133/235 [02:35<02:01,  1.19s/it] 57%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹    | 134/235 [02:36<01:58,  1.17s/it] 57%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹    | 135/235 [02:37<01:58,  1.18s/it] 58%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š    | 136/235 [02:38<01:55,  1.16s/it] 58%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š    | 137/235 [02:39<01:52,  1.15s/it] 59%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š    | 138/235 [02:41<01:50,  1.14s/it] 59%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰    | 139/235 [02:42<01:50,  1.15s/it] 60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰    | 140/235 [02:43<01:50,  1.16s/it] 60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 141/235 [02:44<01:53,  1.21s/it] 60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 142/235 [02:45<01:50,  1.19s/it] 61%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 143/235 [02:47<01:49,  1.19s/it] 61%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 144/235 [02:48<01:44,  1.15s/it] 62%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 145/235 [02:49<01:45,  1.17s/it] 62%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 146/235 [02:50<01:46,  1.19s/it] 63%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 147/235 [02:51<01:45,  1.20s/it] 63%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 148/235 [02:53<01:45,  1.22s/it] 63%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 149/235 [02:54<01:47,  1.25s/it] 64%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 150/235 [02:55<01:46,  1.25s/it] 64%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 151/235 [02:56<01:45,  1.25s/it] 65%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 152/235 [02:58<01:44,  1.26s/it] 65%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 153/235 [02:59<01:42,  1.25s/it] 66%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 154/235 [03:00<01:41,  1.25s/it] 66%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 155/235 [03:01<01:38,  1.24s/it] 66%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 156/235 [03:03<01:38,  1.25s/it] 67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 157/235 [03:04<01:38,  1.26s/it] 67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 158/235 [03:05<01:36,  1.25s/it] 68%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š   | 159/235 [03:06<01:34,  1.24s/it] 68%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š   | 160/235 [03:08<01:33,  1.25s/it] 69%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š   | 161/235 [03:09<01:31,  1.24s/it] 69%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 162/235 [03:10<01:29,  1.22s/it] 69%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 163/235 [03:11<01:26,  1.20s/it] 70%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 164/235 [03:12<01:23,  1.17s/it] 70%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 165/235 [03:14<01:24,  1.21s/it] 71%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 166/235 [03:15<01:24,  1.23s/it] 71%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 167/235 [03:16<01:24,  1.24s/it] 71%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 168/235 [03:17<01:23,  1.25s/it] 72%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 169/235 [03:18<01:19,  1.21s/it] 72%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 170/235 [03:20<01:20,  1.24s/it] 73%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 171/235 [03:21<01:19,  1.24s/it] 73%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 172/235 [03:22<01:18,  1.25s/it] 74%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 173/235 [03:24<01:17,  1.25s/it] 74%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 174/235 [03:25<01:14,  1.22s/it] 74%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 175/235 [03:26<01:12,  1.21s/it] 75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 176/235 [03:27<01:11,  1.21s/it] 75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 177/235 [03:28<01:09,  1.20s/it] 76%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 178/235 [03:29<01:07,  1.18s/it] 76%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 179/235 [03:31<01:05,  1.16s/it] 77%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹  | 180/235 [03:32<01:01,  1.11s/it] 77%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹  | 181/235 [03:33<01:00,  1.12s/it] 77%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹  | 182/235 [03:34<00:58,  1.11s/it] 78%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 183/235 [03:35<00:57,  1.11s/it] 78%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 184/235 [03:36<00:56,  1.10s/it] 79%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 185/235 [03:37<00:55,  1.11s/it] 79%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰  | 186/235 [03:38<00:53,  1.10s/it] 80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰  | 187/235 [03:39<00:53,  1.11s/it] 80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 188/235 [03:40<00:52,  1.11s/it] 80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 189/235 [03:42<00:53,  1.16s/it] 81%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 190/235 [03:43<00:53,  1.19s/it] 81%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 191/235 [03:44<00:52,  1.19s/it] 82%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 192/235 [03:45<00:51,  1.21s/it] 82%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 193/235 [03:47<00:49,  1.19s/it] 83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 194/235 [03:48<00:48,  1.19s/it] 83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 195/235 [03:49<00:46,  1.17s/it] 83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 196/235 [03:50<00:44,  1.15s/it] 84%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 197/235 [03:51<00:43,  1.15s/it] 84%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 198/235 [03:52<00:41,  1.13s/it] 85%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 199/235 [03:53<00:42,  1.18s/it] 85%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 200/235 [03:55<00:41,  1.18s/it] 86%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 201/235 [03:56<00:40,  1.20s/it] 86%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 202/235 [03:57<00:39,  1.20s/it] 86%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹ | 203/235 [03:58<00:37,  1.16s/it] 87%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹ | 204/235 [03:59<00:36,  1.17s/it] 87%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹ | 205/235 [04:01<00:35,  1.17s/it] 88%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š | 206/235 [04:02<00:34,  1.19s/it] 88%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š | 207/235 [04:03<00:33,  1.20s/it] 89%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š | 208/235 [04:04<00:31,  1.17s/it] 89%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰ | 209/235 [04:05<00:29,  1.12s/it] 89%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰ | 210/235 [04:06<00:29,  1.16s/it] 90%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰ | 211/235 [04:08<00:28,  1.19s/it] 90%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 212/235 [04:09<00:26,  1.16s/it] 91%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 213/235 [04:10<00:24,  1.11s/it] 91%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 214/235 [04:11<00:23,  1.12s/it] 91%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 215/235 [04:12<00:23,  1.16s/it] 92%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 216/235 [04:13<00:22,  1.16s/it] 92%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 217/235 [04:14<00:20,  1.16s/it] 93%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 218/235 [04:16<00:20,  1.18s/it] 93%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 219/235 [04:17<00:18,  1.17s/it] 94%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 220/235 [04:18<00:17,  1.16s/it] 94%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 221/235 [04:19<00:16,  1.16s/it] 94%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 222/235 [04:20<00:15,  1.16s/it] 95%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 223/235 [04:21<00:13,  1.16s/it] 95%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 224/235 [04:23<00:12,  1.17s/it] 96%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 225/235 [04:24<00:11,  1.16s/it] 96%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 226/235 [04:25<00:10,  1.12s/it] 97%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 227/235 [04:26<00:09,  1.16s/it] 97%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 228/235 [04:27<00:07,  1.13s/it] 97%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 229/235 [04:28<00:06,  1.08s/it] 98%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 230/235 [04:29<00:05,  1.10s/it] 98%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 231/235 [04:30<00:04,  1.07s/it] 99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 232/235 [04:31<00:03,  1.06s/it] 99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 233/235 [04:32<00:02,  1.06s/it]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 234/235 [04:33<00:01,  1.04s/it]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 235/235 [04:34<00:00,  1.20it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 235/235 [04:34<00:00,  1.17s/it]
/home/docker_user/lan/diffusion_inversion/src/train_net_and_selection.py:204: DeprecationWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  top_indices = df.groupby('label').apply(
wandb: Currently logged in as: tranhuonglantk (glad-test). Use `wandb login --relogin` to force relogin
wandb: wandb version 0.16.6 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.4
wandb: Run data is saved locally in /home/docker_user/lan/diffusion_inversion/wandb/run-20240410_132005-hui6x4s6
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run super-deluge-41
wandb: â­ï¸ View project at https://wandb.ai/glad-test/DI-tiny-imagenet
wandb: ğŸš€ View run at https://wandb.ai/glad-test/DI-tiny-imagenet/runs/hui6x4s6
10000
>>>> Len DATASET after filter:  10000
==> Building model..
>>>>> ResNet resolution:  64  <<<<<
==> Output directory: arch/tiny-imagenet-syn-selection-lowest/tiny-imagenet/_data10000/resnet18_optsgd_lr0.01_wd0.0005_realbs128/seed42
==> No checkpoint found. Train from scratch.
Number of steps per epoch is 79
/home/docker_user/miniconda3/envs/di/lib/python3.10/multiprocessing/popen_fork.py:66: RuntimeWarning: os.fork() was called. os.fork() is incompatible with multithreaded code, and JAX is multithreaded, so this will likely lead to a deadlock.
  self.pid = os.fork()
Running eval at step 0
INFO:absl:==> Saving Checkpoint. Step: 0, Acc: 5.0000
INFO:absl:==> Saving Best Checkpoint. Step: 0, Acc: 5.0000
Running eval at step 1000
INFO:absl:==> Saving Checkpoint. Step: 1000, Acc: 21.3000
INFO:absl:==> Saving Best Checkpoint. Step: 1000, Acc: 21.3000
Running eval at step 2000
INFO:absl:==> Saving Checkpoint. Step: 2000, Acc: 22.3000
INFO:absl:==> Saving Best Checkpoint. Step: 2000, Acc: 22.3000
Running eval at step 3000
INFO:absl:==> Saving Checkpoint. Step: 3000, Acc: 25.0000
INFO:absl:==> Saving Best Checkpoint. Step: 3000, Acc: 25.0000
Running eval at step 4000
INFO:absl:==> Saving Checkpoint. Step: 4000, Acc: 26.7000
INFO:absl:==> Saving Best Checkpoint. Step: 4000, Acc: 26.7000
Running eval at step 5000
INFO:absl:==> Saving Checkpoint. Step: 5000, Acc: 27.4000
INFO:absl:==> Saving Best Checkpoint. Step: 5000, Acc: 27.4000
Running eval at step 6000
INFO:absl:==> Saving Checkpoint. Step: 6000, Acc: 28.5000
INFO:absl:==> Saving Best Checkpoint. Step: 6000, Acc: 28.5000
Running eval at step 7000
INFO:absl:==> Saving Checkpoint. Step: 7000, Acc: 25.7000
wandb: Network error (ReadTimeout), entering retry loop.
Running eval at step 8000
INFO:absl:==> Saving Checkpoint. Step: 8000, Acc: 29.0000
INFO:absl:==> Saving Best Checkpoint. Step: 8000, Acc: 29.0000
Running eval at step 9000
INFO:absl:==> Saving Checkpoint. Step: 9000, Acc: 28.2000
Running eval at step 10000
INFO:absl:==> Saving Checkpoint. Step: 10000, Acc: 28.1000
Running eval at step 11000
INFO:absl:==> Saving Checkpoint. Step: 11000, Acc: 29.0000
Running eval at step 12000
INFO:absl:==> Saving Checkpoint. Step: 12000, Acc: 29.0000
Running eval at step 13000
INFO:absl:==> Saving Checkpoint. Step: 13000, Acc: 29.2000
INFO:absl:==> Saving Best Checkpoint. Step: 13000, Acc: 29.2000
Running eval at step 14000
INFO:absl:==> Saving Checkpoint. Step: 14000, Acc: 26.8000
Running eval at step 15000
INFO:absl:==> Saving Checkpoint. Step: 15000, Acc: 28.1000
Running eval at step 16000
INFO:absl:==> Saving Checkpoint. Step: 16000, Acc: 28.8000
Running eval at step 17000
INFO:absl:==> Saving Checkpoint. Step: 17000, Acc: 28.9000
Running eval at step 18000
INFO:absl:==> Saving Checkpoint. Step: 18000, Acc: 28.8000
Running eval at step 19000
INFO:absl:==> Saving Checkpoint. Step: 19000, Acc: 28.2000
INFO:absl:==> Saving Checkpoint. Step: 20000, Acc: 28.8000
wandb: - 0.015 MB of 0.015 MB uploadedwandb: \ 0.015 MB of 0.015 MB uploadedwandb: | 0.015 MB of 0.015 MB uploadedwandb: / 0.015 MB of 0.015 MB uploadedwandb: - 0.022 MB of 0.027 MB uploaded (0.004 MB deduped)wandb: \ 0.038 MB of 0.038 MB uploaded (0.004 MB deduped)wandb: | 0.038 MB of 0.038 MB uploaded (0.004 MB deduped)wandb: / 0.038 MB of 0.038 MB uploaded (0.004 MB deduped)wandb:                                                                                
wandb: W&B sync reduced upload amount by 9.4%             
wandb: 
wandb: Run history:
wandb: monitor/time_per_step â–â–„â–„â–‚â–…â–ƒâ–‡â–‡â–„â–…â–ˆâ–„â–ˆâ–‡â–…â–„â–…â–ƒâ–„â–„â–„â–„â–ˆâ–†â–‡â–‡â–‡â–„â–†â–ƒâ–„â–ƒâ–„â–„â–â–†â–ƒâ–†â–‡â–ƒ
wandb:             train/acc â–â–†â–‡â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ
wandb:              train/lr â–‚â–…â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‡â–‡â–‡â–‡â–‡â–†â–†â–†â–†â–…â–…â–…â–„â–„â–„â–„â–ƒâ–ƒâ–ƒâ–ƒâ–‚â–‚â–‚â–‚â–‚â–â–â–â–â–â–â–
wandb:      train/train_loss â–ˆâ–ƒâ–‚â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–
wandb:               val/acc â–â–†â–†â–‡â–‡â–‡â–ˆâ–‡â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‡â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ
wandb:         val/test_loss â–â–ˆâ–†â–†â–‡â–†â–†â–‡â–…â–…â–†â–…â–…â–…â–…â–…â–„â–„â–„â–„â–„
wandb: 
wandb: Run summary:
wandb: monitor/time_per_step 0.82645
wandb:             train/acc 99.86979
wandb:              train/lr 1e-05
wandb:      train/train_loss 5e-05
wandb:               val/acc 28.8
wandb:         val/test_loss 0.03971
wandb: 
wandb: ğŸš€ View run super-deluge-41 at: https://wandb.ai/glad-test/DI-tiny-imagenet/runs/hui6x4s6
wandb: ï¸âš¡ View job at https://wandb.ai/glad-test/DI-tiny-imagenet/jobs/QXJ0aWZhY3RDb2xsZWN0aW9uOjE2MDg5MDU2OA==/version_details/v2
wandb: Synced 6 W&B file(s), 0 media file(s), 2 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240410_132005-hui6x4s6/logs
